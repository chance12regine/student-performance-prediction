<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Performance Predictor</title>
    <style>
        :root{
            --bg-1: #f6fbff;
            --bg-2: #eef6ff;
            --accent: #0b74ff;
            --accent-2: #3db0ff;
            --muted: #506070;
            --card-bg: #ffffff;
            --glass: rgba(2,6,23,0.02);
            --shadow-1: 0 8px 24px rgba(11,116,255,0.08);
            --shadow-2: 0 16px 40px rgba(2,6,23,0.06);
            --input-bg: #fbfdff;
            --input-border: #e6eefc;
            --text: #07263a;
        }

        *{box-sizing:border-box;margin:0;padding:0}
        html,body{height:100%;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;background:linear-gradient(135deg,var(--bg-1),var(--bg-2));color:var(--text)}
        body{display:flex;align-items:center;justify-content:center;padding:28px}

        .shell{width:100%;max-width:920px;display:grid;grid-template-columns:1fr 420px;gap:28px;align-items:start}

        .hero{padding:28px;border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,0.9),rgba(250,253,ff,0.95));box-shadow:var(--shadow-1);border:1px solid var(--input-border)}

        .card{background:var(--card-bg);border-radius:14px;padding:22px;box-shadow:var(--shadow-2);border:1px solid var(--input-border)}

        h1{font-size:26px;color:var(--text);margin-bottom:6px}
        p.lead{color:var(--muted);margin-bottom:14px}

        .features{display:flex;flex-direction:column;gap:10px;margin-top:8px}
        .feature{display:flex;gap:12px;align-items:flex-start}
        .dot{width:10px;height:10px;border-radius:50%;background:var(--accent)}

        form{display:flex;flex-direction:column;gap:12px}

        label{font-size:13px;color:var(--text);font-weight:600}
        input[type=number]{width:100%;padding:12px 14px;border-radius:10px;border:1px solid var(--input-border);background:var(--input-bg);color:var(--text);font-size:15px}

        .row{display:flex;gap:12px}
        .row .col{flex:1}

        .checkbox-inline{display:flex;align-items:center;gap:10px}
        input[type=checkbox]{width:18px;height:18px;accent-color:var(--accent)}

        .btn{padding:12px 16px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;font-weight:700;cursor:pointer;box-shadow:0 12px 30px rgba(11,116,255,0.12);transition:transform .12s ease,box-shadow .12s ease}
        .btn:active{transform:translateY(1px)}

        #resetBtn{background:transparent;border-radius:10px;padding:12px 14px;border:1px solid var(--input-border);color:var(--muted);font-weight:700;cursor:pointer}

        .result{padding:14px;border-radius:10px;text-align:center;display:none}
        .result.success{background:linear-gradient(90deg,rgba(61,176,255,0.08),rgba(29,88,255,0.04));color:#01334d}
        .result.error{background:linear-gradient(90deg,rgba(255,90,90,0.06),rgba(140,30,30,0.03));color:#7a1f1f}

        .loading{display:none;text-align:center}

        @media(max-width:880px){.shell{grid-template-columns:1fr;max-width:720px}.hero{order:2}}
    </style>
</head>

<body>
    <div class="shell">
        <div class="card hero">
            <h1>Student Performance Predictor</h1>
            <p class="lead">Quickly estimate your performance index using your study habits and past scores.</p>

            <div class="features">
                <div class="feature"><div class="dot"></div><div><strong>Fast predictions</strong><div style="color:var(--muted);font-size:13px">Instant feedback using our lightweight model</div></div></div>
                <div class="feature"><div class="dot"></div><div><strong>Privacy first</strong><div style="color:var(--muted);font-size:13px">No data leaves this app unless you save it</div></div></div>
                <div class="feature"><div class="dot"></div><div><strong>Actionable tips</strong><div style="color:var(--muted);font-size:13px">Get focused suggestions based on results</div></div></div>
            </div>
        </div>

        <div class="card">
            <form id="predictionForm">
                <div>
                    <label for="hours_studied">Hours Studied per Day</label>
                    <input type="number" id="hours_studied" name="hours_studied" min="0" max="24" required>
                </div>

                <div>
                    <label for="previous_scores">Previous Test Scores (0-100)</label>
                    <input type="number" id="previous_scores" name="previous_scores" min="0" max="100" required>
                </div>

                <div class="row">
                    <div class="col">
                        <label for="sleep_hours">Sleep Hours per Night</label>
                        <input type="number" id="sleep_hours" name="sleep_hours" min="0" max="24" required>
                    </div>
                    <div class="col">
                        <label for="sample_papers">Sample Papers Practiced</label>
                        <input type="number" id="sample_papers" name="sample_papers" min="0" required>
                    </div>
                </div>

                <div>
                    <label>Extracurricular Activities</label>
                    <div class="checkbox-inline">
                        <input type="checkbox" id="extracurricular" name="extracurricular">
                        <label for="extracurricular" style="font-weight:500;color:var(--muted);">I participate in extracurricular activities</label>
                    </div>
                </div>

                <div style="display:flex;gap:12px;margin-top:8px">
                    <button type="submit" class="btn">Predict My Performance</button>
                    <button type="button" id="resetBtn" style="background:#f3f6fb;border-radius:10px;padding:12px 14px;border:1px solid #e6eefc;color:var(--accent-2);font-weight:700;cursor:pointer">Reset</button>
                </div>

                <div class="loading" id="loading" style="margin-top:12px">
                    <div style="height:6px;background:linear-gradient(90deg,var(--accent),var(--accent-2));border-radius:6px;width:100%;animation:progress 1.2s linear infinite"></div>
                </div>

                <div class="result" id="result" style="margin-top:12px">
                    <h3 id="resultTitle"></h3>
                    <p id="resultMessage"></p>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.getElementById('predictionForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const loading = document.getElementById('loading');
            const result = document.getElementById('result');
            const resultTitle = document.getElementById('resultTitle');
            const resultMessage = document.getElementById('resultMessage');

            // Show loading
            loading.style.display = 'block';
            result.style.display = 'none';

            const formData = new FormData(this);
            const data = {
                hours_studied: parseInt(formData.get('hours_studied')),
                previous_scores: parseInt(formData.get('previous_scores')),
                extracurricular: formData.get('extracurricular') === 'on',
                sleep_hours: parseInt(formData.get('sleep_hours')),
                sample_papers: parseInt(formData.get('sample_papers'))
            };

            try {
                const response = await fetch('/api/predict/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken')
                    },
                    body: JSON.stringify(data)
                });

                const responseData = await response.json();

                if (response.ok) {
                    const performanceIndex = responseData.predicted_performance_index;
                    let status = '';
                    let message = '';

                    if (performanceIndex >= 80) {
                        status = 'Excellent';
                        message = `Your predicted performance index is ${performanceIndex}. You're on track for outstanding results!`;
                    } else if (performanceIndex >= 60) {
                        status = 'Good';
                        message = `Your predicted performance index is ${performanceIndex}. Keep up the great work!`;
                    } else if (performanceIndex >= 40) {
                        status = 'Needs Improvement';
                        message = `Your predicted performance index is ${performanceIndex}. There's room for improvement - consider studying more or getting better sleep!`;
                    } else {
                        status = 'Requires Focus';
                        message = `Your predicted performance index is ${performanceIndex}. Focus on consistent study habits and you'll see improvement.`;
                    }

                    resultTitle.textContent = `Performance Prediction - ${status}`;
                    resultMessage.textContent = message;
                    result.className = 'result success';
                } else {
                    // show server-provided errors when possible
                    let errMsg = 'Sorry, there was an error making the prediction. Please try again.';
                    try { const body = await response.json(); if (body && typeof body === 'object') errMsg = JSON.stringify(body); } catch(e){}
                    resultTitle.textContent = 'Prediction Error';
                    resultMessage.textContent = errMsg;
                    result.className = 'result error';
                }
            } catch (error) {
                resultTitle.textContent = 'Prediction Error';
                resultMessage.textContent = 'Sorry, there was an error making the prediction. Please try again.';
                result.className = 'result error';
            }

            loading.style.display = 'none';
            result.style.display = 'block';
        });

        document.getElementById('resetBtn').addEventListener('click', function(){
            document.getElementById('predictionForm').reset();
            const result = document.getElementById('result'); result.style.display='none';
        });

        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // small progress bar animation keyframes
        const style = document.createElement('style');
        style.innerHTML = `@keyframes progress{0%{transform:translateX(-40%)}100%{transform:translateX(140%)}}`;
        document.head.appendChild(style);
    </script>
</body>

</html>